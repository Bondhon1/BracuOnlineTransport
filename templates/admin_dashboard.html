{% extends 'app.html' %}

{% block content %}
<div class="container mt-2">
    <h2 class="text-center mb-2">Admin Dashboard</h2>

    <!-- Flash Message Section -->
    {% with messages = get_flashed_messages(category_filter=["success", "danger", "info"]) %}
    {% if messages %}
        <div class="alert alert-success alert-dismissible fade show text-center" role="alert">
            {% for message in messages %}
                <strong>{{ message }}</strong>
            {% endfor %}
            <button type="button" class="close" data-bs-dismiss="alert" aria-label="Close">&times;</button>
        </div>
    {% endif %}
    {% endwith %}

    <!-- Welcome Message -->
    <div id="welcomeMessage" class="alert alert-info text-center py-4">
        <h4 class="m-0">Hello, {{ admin[0] }}! Welcome back.</h4>
    </div>

    <!-- Analytics Overview Section -->
    <div class="row text-center my-2">
        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">Total Users</h5>
                    <p class="display-4 text-primary">{{ total_users }}</p>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">Pending Vehicle Requests</h5>
                    <p class="display-4 text-warning">{{ pending_requests }}</p>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h5 class="card-title">Pending Feedback Replies</h5>
                    <p class="display-4 text-danger">{{ pending_feedback }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Action Buttons Section -->
    <div class="row mt-4">
        <div class="col-md-12 text-center">
            <div class="btn-group-vertical w-50 mx-auto">
                <a href="/add_admin" class="btn btn-success mb-2">Add Admin</a>
                <a href="/view_users" class="btn btn-primary mb-2">View Users</a>
                <a href="/view_faculty_staff" class="btn btn-secondary mb-2">View Faculty & Staff</a>
                <a href="/add_bus_route" class="btn btn-warning mb-2">Add Bus Schedule</a>
                <a href="/add_bus_stop" class="btn btn-info mb-2">Add Bus Stop</a>
                <a href="/view_requests" class="btn btn-secondary mb-2">View Vehicle Requests</a>
                <a href="/view_feedback" class="btn btn-light text-dark mb-2 border">View User Feedback</a>
                <a href="/logout" class="btn btn-danger">Logout</a>
            </div>
        </div>
    </div>
</div>

<script>
    // Fade out the welcome message after 5 seconds
    document.addEventListener('DOMContentLoaded', () => {
        const welcomeMessage = document.getElementById('welcomeMessage');
        if (welcomeMessage) {
            setTimeout(() => {
                welcomeMessage.style.transition = "opacity 1s ease, height 2s ease";
                welcomeMessage.style.opacity = "0";
                welcomeMessage.style.height = "0";
                welcomeMessage.style.padding = "0";
                welcomeMessage.style.margin = "0";
            }, 3000); // Delay before fading out (5 seconds)
        }
    });
</script>

<style>
    #welcomeMessage {
        border: 1px solid #17a2b8;
        background-color: #d1ecf1;
        color: #0c5460;
        transition: opacity 1s ease, height 1s ease;
    }

    /* Additional styling for cards and buttons */
    .card {
        border: none;
        border-radius: 8px;
    }

    .btn {
        font-size: 16px;
        font-weight: 500;
    }

    .btn-group-vertical a {
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
</style>
{% endblock %}
